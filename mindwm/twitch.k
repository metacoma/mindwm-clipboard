import kando.schema as kando
import kando.utils as utils

schema TwitchClip:
  slug: str
  title: str
  createdAt: str
  viewCount: int
  durationSeconds: int
  url: str
  category: str
  broadcaster: str

makeMenuTwitchClip = lambda clip : any -> kando.Child {
  windows = []
  r = utils.makeSubmenu({
    name = clip.slug[0:24],
    icon = "ğŸ¬"
    children = [
      utils.makeCommand({
        name = "Download"
        icon = "ğŸ’¾"
        cmd = "gnome-terminal -- ~/bin/twitch-dl download -q source ${clip.slug}"
      })
      utils.makeSubmenu({
        name = clip.broadcaster
        icon = "ğŸŸ£ğŸ“º"
        children = [
          utils.makeURI({
            name = "profile"
            icon = "ğŸ§‘â€ğŸ’»"
            uri = "https://twitch.tv/${clip.broadcaster}"
          })
          utils.makeURI({
            name = "clips"
            icon = "âœ‚ï¸"
            uri = "https://www.twitch.tv/${clip.broadcaster}/clips?filter=clips&range=7d"
          })
        ]
      })
      utils.showText({
        name = "${clip.viewCount}"
        icon = "ğŸ§‘â€ğŸ¤â€ğŸ§‘"
        text = "${clip.viewCount}"
      })
      utils.showText({
        name = "${clip.durationSeconds}"
        icon = "â±ï¸"
        text = "${clip.durationSeconds}"
      })
      utils.showText({
        name = "${clip.category}"
        icon = "ğŸ®"
        text = "${clip.category}"
      })
      utils.showText({
        name = "${clip.title}"
        icon = "ğŸ·ï¸"
        text = "${clip.title}"
      })
    ]
  })
  r
}
